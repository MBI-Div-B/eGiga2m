var version="1.15.9",visited=[],activePoint=-1,mychart=-1,myPlot=-1,myRequest,myStart,myStop,exportURL="undefined",plotURL="undefined",jsonURL="undefined",exportFormat="csv",exportBlanks="",exportDecimation="",curves,myPlotClass=[],myHistory=[],myHistoryCounter=-1,plotService="./lib/service/plot_service.php?conf=",treeService="./lib/service/tree_service.php?conf=",updateService="",exportService="./lib/service/export_service.php?conf=",hcExportService="http://export.highcharts.com",zoom_speed=document.getElementById("zoomFactor")?
document.getElementById("zoomFactor").value:10,globalVal,globalLabel,minVal,maxVal,tsLabel,animationDelay,frameNum,updatePlot=0,decimation="maxmin",decimationSamples=1E3,updateBackground=300,updateRequest="",updateDecimation=0,updateCounter=0,updateId=!1,downtimeCheck=!1,visible=[],flotOptions={series:{lines:{show:!0}},grid:{hoverable:!0,clickable:!0},xaxis:{tickLength:5},yaxis:{position:"left"},legend:{position:"sw"},canvas:!0},fade_level=[];for(j=0;j<events.length;j++)fade_level[events[j]]=1;
var $_GET=getQueryParams(document.location.search);"undefined"!==typeof $_GET.conf?(document.getElementById("conf").value=$_GET.conf,initConf($_GET.conf)):initConf(!1);"undefined"!==typeof $_GET.visible&&(visible=$_GET.visible.split(";"));"undefined"!==typeof $_GET.decimation&&(decimation=$_GET.decimation);"undefined"!==typeof $_GET.hideOverMaxmin&&document.getElementById("hideOverMaxmin")&&(document.getElementById("hideOverMaxmin").checked=!0);
"undefined"!==typeof $_GET.downtimeCheck&&(downtimeCheck=!0);document.getElementById("downtimeCheck")&&(document.getElementById("downtimeCheck").checked=downtimeCheck);document.getElementById("decimation_"+decimation)&&(document.getElementById("decimation_"+decimation).selected=!0);"undefined"!==typeof $_GET.decimation_samples&&(decimationSamples=$_GET.decimation_samples);document.getElementById("decimationSamples")&&(document.getElementById("decimationSamples").value=decimationSamples);
"boolean"!==typeof isHighChartsInstalled&&document.getElementById("show_flot")&&(document.getElementById("show_flot").checked=!0,document.getElementById("show_hc").checked=!1,document.getElementById("show_error").checked=!1,document.getElementById("style_output").style.display="none");"undefined"===typeof formula_edit&&initPlot($_GET);"undefined"!==typeof window.$_GET.tsLabel&&(tsLabel=window.$_GET.tsLabel.split(";"));initTree($_GET);
"string"===typeof see_also&&document.getElementById("see_also")&&(document.getElementById("see_also_button").style.display="inline");function update_see_also(){var a={"\x3c!--start--\x3e":document.getElementById("startInput").value,"\x3c!--stop--\x3e":document.getElementById("stopInput").value,"\x3c!--decimation--\x3e":decimation};document.getElementById("see_also").innerHTML=strtr(see_also,a)}
function popup(a,b,d){this.popupWindow=null;this.open=function(){this.popupWindow?this.popupWindow.closed?this.popupWindow=window.open(a,b,d):this.popupWindow.focus():this.popupWindow=window.open(a,b,d)}}if("undefined"!==typeof $_GET.formula){var myPopup=new popup("./formula_editor.html?conf="+$_GET.conf,"formula","width=670,height=800");myPopup.open()}
function print_r(a){var b=new popup("","mywindow","width=600,height=400");b.open();if(a.constructor==Array||a.constructor==Object){b.popupWindow.document.write("<ul>");for(var d in a)a[d].constructor==Array||a[d].constructor==Object?(b.popupWindow.document.write("<li>["+d+"] => "+typeof a+"</li>"),b.popupWindow.document.write("<ul>"),print_r(a[d]),b.popupWindow.document.write("</ul>")):b.popupWindow.document.write("<li>["+d+"] => "+a[d]+"</li>");b.popupWindow.document.write("</ul>")}}
function openFormula(){(new popup("./formula_editor.html?conf="+document.getElementById("conf").value,"formula","width=670,height=800")).open()}function returnFormula(a){document.getElementById("ts").value=a+";"+document.getElementById("ts").value}var hidden,visibilityChange;
"undefined"!==typeof document.hidden?(hidden="hidden",visibilityChange="visibilitychange"):"undefined"!==typeof document.mozHidden?(hidden="mozHidden",visibilityChange="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(hidden="msHidden",visibilityChange="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(hidden="webkitHidden",visibilityChange="webkitvisibilitychange");var videoElement=document.getElementById("videoElement");
function handleVisibilityChange(){updateDecimation=document[hidden]?Math.ceil(updateBackground/updatePlot):updateDecimation=0}"undefined"===typeof document.addEventListener||"undefined"===typeof document[hidden]?alert("This feature requires a browser, such as Google Chrome or Firefox, that supports the Page Visibility API."):document.addEventListener(visibilityChange,handleVisibilityChange,!1);
function updateLink(a){var b="";if(document.getElementById("ts").value.length)b="&ts="+document.getElementById("ts").value;else{var d=[];$("#tree").fancytree("getTree").visit(function(a){a.folder||("./img/y1axis.png"==a.data.icon&&d.push(a.key+",1,1"),"./img/y2axis.png"==a.data.icon&&d.push(a.key+",1,2"),"./img/surface.png"==a.data.icon&&d.push(a.key+",surface"),"./img/animation.png"==a.data.icon&&d.push(a.key+",animation"),"./img/multi.png"==a.data.icon&&d.push(a.key+",multi"))});d.length&&(b="&ts="+
d.join(";"))}var g="";document.getElementById("start").value.length?g="&start="+document.getElementById("start").value:document.getElementById("startInput").value.length&&(g="&start="+document.getElementById("startInput").value);var h="";document.getElementById("stop").value.length?h="&stop="+document.getElementById("stop").value:document.getElementById("startInput")&&document.getElementById("startInput").value.length&&(h="&stop="+document.getElementById("stopInput").value);var e=document.getElementById("conf").value.length?
"conf="+document.getElementById("conf").value:"conf=",l="",m=document.getElementById("minY").value;1<m.length&&(l="&minY="+m);m=document.getElementById("maxY").value;1<m.length&&(l+="&maxY="+m);m=document.getElementById("logY").value;""!=m&&"0;0"!=m&&(l+="&logY="+m);var p=document.getElementById("style").value;p.length&&(p="&style="+p);var q=document.getElementById("height").value;q.length&&(q="&height="+q);m=document.getElementById("show_flot").checked?"&show_flot=true":"";var v=document.getElementById("show_table").checked?
"&show_table=true":"",r="undefined"!==typeof location.pathname?location.pathname:"undefined"!==typeof window.location.pathname?window.location.pathname:"undefined"!==typeof document.location.pathname?document.location.pathname:"./egiga2m.html";path=r.split("/");var t="";for(j=0;j<events.length;j++)t+=document.getElementById("show_"+events[j]).checked?"&show_"+events[j]+"="+document.getElementById("filter_"+events[j]).value:"";var n=window.location.protocol+"//"+window.location.host+path.join("/");
path[path.length-1]=-1==r.indexOf(".html")?path[path.length-1]+"index_plot.html":path[path.length-1].replace(".html","_plot.html");plotURL=window.location.protocol+"//"+window.location.host+path.join("/");path.pop();0==exportService.indexOf("./")&&(exportService=window.location.protocol+"//"+window.location.host+path.join("/")+exportService.substr(1));exportURL=exportService+g+h+b;var w=document.getElementById("downtimeCheck").checked?"&downtimeCheck=true":"",x="maxmin"!==decimation?"&decimation="+
decimation:"",u=1E3!=decimationSamples?"&decimationSamples="+decimationSamples:"",z=document.getElementById("hideOverMaxmin")&&document.getElementById("hideOverMaxmin").checked?"&hideOverMaxmin=true":"";r=e+g+h+b;l=l+p+q+x+u+w+z;jsonURL=window.location.protocol+"//"+window.location.host+path.join("/")+plotService.substr(1)+g+h+b+l;b=window.location.protocol+"//"+window.location.host+path.join("/")+treeService.substr(1)+g+h+b+l;if("undefined"!==typeof a){if("history"==a)return r+l+""+m+v;window.location=
n+"?"+e+g+h+"&ts="+a+l+m+v}else document.getElementById("plotOnly").setAttribute("onClick","javascript: location='"+plotURL+"?"+r+l+m+v+t+"'"),document.getElementById("plotOnly").innerHTML=plotURL+"?"+r+l+m+v+t,document.getElementById("plotAndControls").setAttribute("onClick","javascript: location='"+n+"?"+r+l+m+v+t+"'"),document.getElementById("plotAndControls").innerHTML=n+"?"+r+l+m+v+t,document.getElementById("scratch")&&(document.getElementById("scratch").setAttribute("onClick","javascript: location='"+
n+"?"+e+"'"),document.getElementById("scratch").innerHTML=n+"?"+e),exportBlanks=document.getElementById("exportZoh").checked?"&zoh":document.getElementById("exportFoh").checked?"&foh":"",exportFormat=document.getElementById("exportCsv").checked?"csv":"",exportFormat=document.getElementById("exportXls").checked?"xlsx":exportFormat,exportFormat=document.getElementById("exportMat").checked?"mat":exportFormat,exportFormat=document.getElementById("exportIgor").checked?"itx":exportFormat,exportFormat=document.getElementById("exportJson")&&
document.getElementById("exportJson").checked?"json":exportFormat,exportDecimation=evalExportDecimation(),refreshExportLink(),document.getElementById("exportCsv").setAttribute("onClick","javascript: exportFormat = 'csv';document.getElementById('matDisabled').style.display='inline'; refreshExportLink();"),document.getElementById("exportXls").setAttribute("onClick","javascript: exportFormat = 'xlsx';document.getElementById('matDisabled').style.display='inline'; refreshExportLink();"),document.getElementById("exportMat")&&
document.getElementById("exportMat").setAttribute("onClick","javascript: exportFormat = 'mat';document.getElementById('matDisabled').style.display='none'; refreshExportLink();"),document.getElementById("exportIgor")&&document.getElementById("exportIgor").setAttribute("onClick","javascript: exportFormat = 'itx';document.getElementById('matDisabled').style.display='inline'; refreshExportLink();"),document.getElementById("exportJson")&&(document.getElementById("exportJson").setAttribute("onClick","javascript: exportFormat = 'json';document.getElementById('matDisabled').style.display='none'; refreshExportLink();"),
document.getElementById("exportJson").innerHTML=jsonURL),document.getElementById("exportTreeJson")&&(document.getElementById("exportTreeJson").setAttribute("onClick","javascript: location='"+b+"'"),document.getElementById("exportTreeJson").innerHTML=b),document.getElementById("exportBlanks").setAttribute("onClick","javascript: exportBlanks = '';refreshExportLink();"),document.getElementById("exportZoh").setAttribute("onClick","javascript: exportBlanks = '&zoh';refreshExportLink();"),document.getElementById("exportFoh").setAttribute("onClick",
"javascript: exportBlanks = '&foh';refreshExportLink();"),document.getElementById("exportSamplesNumber").setAttribute("onChange","javascript: exportDecimation = evalExportDecimation();refreshExportLink();"),document.getElementById("exportMaxmin").setAttribute("onClick","javascript: exportDecimation = evalExportDecimation();refreshExportLink();"),document.getElementById("exportMean").setAttribute("onClick","javascript: exportDecimation = evalExportDecimation();refreshExportLink();"),document.getElementById("exportAvg").setAttribute("onClick",
"javascript: exportDecimation = evalExportDecimation();refreshExportLink();"),document.getElementById("tsLabel").setAttribute("onChange","javascript: refreshExportLink();"),document.getElementById("nullValue").setAttribute("onChange","javascript: refreshExportLink();"),document.getElementById("multiParam").value=plotURL+"?"+r+l+m+t}
function getFormattedDate(a){a=new Date(a);var b=a.getMonth()+1,d=a.getDate(),g=a.getHours(),h=a.getMinutes(),e=a.getSeconds();b=(10>b?"0":"")+b;d=(10>d?"0":"")+d;g=(10>g?"0":"")+g;h=(10>h?"0":"")+h;e=(10>e?"0":"")+e;return a.getFullYear()+"-"+b+"-"+d+" "+g+":"+h+":"+e}
function previous_period(){var a=document.getElementById("startInput").value,b=document.getElementById("stopInput").value;if(19==a.length&&-1==a.indexOf("last")){var d=a.substring(0,10)+"T"+a.substring(11);if(19==b.length&&-1==b.indexOf("last")){var g=b.substring(0,10)+"T"+b.substring(11);g=(new Date(g)).getTime()-(new Date(d)).getTime();document.getElementById("stopInput").value=a;document.getElementById("startInput").value=getFormattedDate((new Date(d)).getTime()-g)}2>b.length&&(document.getElementById("stopInput").value=
a,document.getElementById("startInput").value=getFormattedDate((new Date(d)).getTime()-864E5))}-1!==a.indexOf("last")&&(a=a.split(" "),a[1]*=2,document.getElementById("startInput").value=a.join(" "))}
function following_period(){var a=document.getElementById("startInput").value,b=document.getElementById("stopInput").value;if(19==a.length&&-1==a.indexOf("last")){var d=a.substring(0,10)+"T"+a.substring(11);if(19==b.length&&-1==b.indexOf("last")){var g=b.substring(0,10)+"T"+b.substring(11),h=(new Date(g)).getTime()-(new Date(d)).getTime();document.getElementById("startInput").value=b;document.getElementById("stopInput").value=getFormattedDate((new Date(g)).getTime()+h)}2>b.length&&(document.getElementById("stopInput").value=
getFormattedDate((new Date(d)).getTime()+864E5))}-1!==a.indexOf("last")&&(a=a.split(" "),a[1]=Math.round(a[1]/2),document.getElementById("startInput").value=a.join(" "))}
function evalExportDecimation(){var a="";if(document.getElementById("exportMaxmin").checked||document.getElementById("exportMean").checked||document.getElementById("exportAvg").checked)a="&decimation=",0<document.getElementById("exportSamplesNumber").value&&(a+=document.getElementById("exportSamplesNumber").value),document.getElementById("exportMaxmin").checked&&(a+=",maxmin"),document.getElementById("exportMean").checked&&(a+=",mean"),document.getElementById("exportAvg").checked&&(a+=",avg");return a}
function refreshExportLink(){var a=document.getElementById("tsLabel").value.length?"&tsLabel="+document.getElementById("tsLabel").value:"";a+=document.getElementById("nullValue").value.length?"&nullValue="+document.getElementById("nullValue").value:"";"json"===exportFormat?(document.getElementById("exportLink").innerHTML=jsonURL,document.getElementById("exportLink").setAttribute("onClick","javascript: location='"+jsonURL+"'")):(document.getElementById("exportLink").innerHTML=exportURL+"&format="+
exportFormat+exportBlanks+exportDecimation+a,document.getElementById("exportLink").setAttribute("onClick","javascript: location='"+exportURL+"&format="+exportFormat+exportBlanks+exportDecimation+a+"'"))}
function plotCallback(){activePoint=-1;animationDelay=0;document.getElementById("placeholder").style.border="0px";decimationSamples=document.getElementById("decimationSamples")?document.getElementById("decimationSamples").value:"maxmin";decimation=document.getElementById("decimation")?document.getElementById("decimation").value:1E3;myPlotClass=[];document.getElementById("startInput").value.length&&(document.getElementById("start").value=document.getElementById("startInput").value);start=document.getElementById("start").value;
document.getElementById("stop").value=document.getElementById("stopInput").value;stop=document.getElementById("stop").value;var a=!1,b=[];$("#tree").fancytree("getTree").visit(function(d){d.folder||("./img/y1axis.png"==d.data.icon&&b.push(d.key+",1,1"),"./img/y2axis.png"==d.data.icon&&b.push(d.key+",1,2"),"./img/multi.png"==d.data.icon&&b.push(d.key+",multi"),"./img/surface.png"==d.data.icon&&(plotSurfaceTs(d.key,start,stop),b.push(d.key+",surface"),a=!0,document.getElementById("animationControls").style.display=
"none"),"./img/animation.png"==d.data.icon&&(document.getElementById("animationControls").style.display="inline",frameNum=0,document.getElementById("show_flot").checked&&(flotAnimationTs(d.key,start,stop),b.push(d.key+",animation"),a=!0),document.getElementById("show_hc").checked&&(hcAnimationTs(d.key,start,stop),b.push(d.key+",animation"),a=!0)))});var d=b.join(";");document.getElementById("ts").value=d;a||(document.getElementById("animationControls").style.display="none");!1!==updateId&&(clearInterval(updateId),
updateId=!1);document.getElementById("hidetree").style.display="inline";a||plotTs(d,start,stop);add_history(0)}
function initPlot(a){$("#tree").width($("#configContainer").width());for(j=0;j<events.length;j++)"undefined"!==typeof a["show_"+events[j]]&&(document.getElementById("show_"+events[j]).checked=!0,a["show_"+events[j]].length&&"1"!==a["show_"+events[j]]&&(document.getElementById("filter_"+events[j]).value=a["show_"+events[j]]));"undefined"!==typeof a.minY&&(document.getElementById("minY").value=a.minY);"undefined"!==typeof a.maxY&&(document.getElementById("maxY").value=a.maxY);"undefined"!==typeof a.logY&&
(document.getElementById("logY").value=a.logY);"undefined"!==typeof a.height&&(document.getElementById("height").value=a.height);"undefined"!==typeof a.style&&(document.getElementById("style").value=a.style);if("undefined"!==typeof a.start&&"undefined"!==typeof a.ts){document.getElementById("placeholder").style.border="0px";var b=a.start;document.getElementById("start").value=b;document.getElementById("startInput")&&(document.getElementById("startInput").value=b);var d="";"undefined"!==typeof a.stop?
(d=a.stop,document.getElementById("stopInput")&&(document.getElementById("stopInput").value=d),document.getElementById("stop").value=d):(document.getElementById("stopInput")&&(document.getElementById("stopInput").value=""),document.getElementById("stop").value="");var g=a.ts;0<=g.indexOf("surface")?(g=g.split(","),plotSurfaceTs(g[0],b,d)):0<=g.indexOf("animation")?(g=g.split(","),document.getElementById("animationControls").style.display="inline","undefined"!==typeof a.show_flot?flotAnimationTs(g[0],
b,d):hcAnimationTs(g[0],b,d)):(document.getElementById("hidetree")&&(document.getElementById("hidetree").style.display="inline"),"undefined"!==typeof document.getElementById("ts")&&(document.getElementById("ts").value=g),"undefined"!==typeof a.show_flot&&document.getElementById("show_flot")&&(document.getElementById("show_flot").checked=!0,document.getElementById("show_hc").checked=!1),"undefined"!==typeof a.show_table&&document.getElementById("show_table")&&(document.getElementById("show_table").checked=
!0),plotTs(g,b,d),add_history(0))}}
function initTree(a){if($("#tree").length){var b=treeService,d=$(window).height()-320;150>d&&(d=150);"undefined"===typeof formula_edit&&$(tree).width(250).height(d);"undefined"!==typeof a.ts&&(b=b+"&ts="+a.ts);$("#tree").fancytree({autoScroll:!0,source:{url:b},lazyLoad:function(a,b){b.result={url:treeService,data:{key:b.node.key}}},click:function(a,b){if("icon"==b.targetType||"title"==b.targetType)"undefined"===typeof formula_edit?(b.node.data.isArray?"./img/y0axis.png"==b.node.data.icon?(b.node.data.icon=
"./img/surface.png",b.node.data.tooltip="surface display"):"./img/surface.png"==b.node.data.icon?(b.node.data.icon="./img/animation.png",b.node.data.tooltip="animation display"):"./img/animation.png"==b.node.data.icon?(b.node.data.icon="./img/multi.png",b.node.data.tooltip="multi line display"):"./img/multi.png"==b.node.data.icon&&(b.node.data.icon="./img/y0axis.png",b.node.data.tooltip="not selected"):b.node.data.isString?"./img/y0axis.png"==b.node.data.icon?(b.node.data.icon="./img/table.png",b.node.data.tooltip=
"show table"):"./img/table.png"==b.node.data.icon&&(b.node.data.icon="./img/y0axis.png",b.node.data.tooltip="not selected"):"./img/y0axis.png"==b.node.data.icon?(b.node.data.icon="./img/y1axis.png",b.node.data.tooltip="show on Y1 axis"):"./img/y1axis.png"==b.node.data.icon?(b.node.data.icon="./img/y2axis.png",b.node.data.tooltip="show on Y2 axis"):"./img/y2axis.png"==b.node.data.icon&&(b.node.data.icon="./img/y0axis.png",b.node.data.tooltip="not selected"),b.node.data.tooltip="click to switch display mode",
b.node.render(!0),b.node.parent.sortChildren()):$.get(treeService+"&reversekey="+b.node.key,function(a){a.length&&append2formula('"'+a+'"')});return!0},clickFolderMode:2,persist:!0});updateLink()}}
function switchtree(){if("<img src='./img/right.png'>"==document.getElementById("hidetree").InnerHTML){document.getElementById("hidetree").InnerHTML="<img src='./img/y0axis.png'>";$("body").find("#hidetree").html("<img src='./img/y0axis.png'>");document.getElementById("treeid").style.display="inline";var a=$(window).width()-280}else document.getElementById("hidetree").InnerHTML="<img src='./img/right.png'>",$("body").find("#hidetree").html("<img src='./img/right.png'>"),document.getElementById("treeid").style.display=
"none",a=$(window).width()-30;300>a&&(a=300);$("#mybackground").width(a).height(height-0+10+"px");$("#placeholder").width(a-10).height(height+"px");rePlotTs()}function rePlotTs(){document.getElementById("height").value.length?document.getElementById("height"):$(window).height();document.getElementById("show_flot")&&document.getElementById("show_flot").checked?(myPlot.resize(),myPlot.draw()):myPlot.reflow()}
function applyConf(){document.getElementById("minY").value=document.getElementById("minY1set").value+";"+document.getElementById("minY2set").value;document.getElementById("maxY").value=document.getElementById("maxY1set").value+";"+document.getElementById("maxY2set").value;document.getElementById("logY").value=(document.getElementById("logY1set").checked?"1":"0")+";"+(document.getElementById("logY2set").checked?"1":"0");document.getElementById("style").value=document.getElementById("styleSet").value}
function updateConf(){minY=document.getElementById("minY").value.split(";");maxY=document.getElementById("maxY").value.split(";");logY=document.getElementById("logY").value.split(";");document.getElementById("minY1set").value=minY[0];document.getElementById("maxY1set").value=maxY[0];document.getElementById("logY1set").checked="1"==logY[0];document.getElementById("minY2set").value="undefined"===typeof minY[1]?"":minY[1];document.getElementById("maxY2set").value="undefined"===typeof maxY[1]?"":maxY[1];
document.getElementById("logY2set").checked="1"==logY[1];document.getElementById("style_scatter").selected="scatter"==document.getElementById("style").value;document.getElementById("style_step").selected="step"==document.getElementById("style").value;document.getElementById("style_line").selected="line"==document.getElementById("style").value;document.getElementById("style_spline").selected="spline"==document.getElementById("style").value}
function updateAbout(){$("body").find("#aboutVersion").html(version)}function applySearch(){var a=[];for(i=0;i<document.getElementById("Y1search").length;i++)document.getElementById("Y1search").options[i].selected&&a.push(document.getElementById("Y1search").options[i].value);for(j=0;j<document.getElementById("Y2search").length;j++)document.getElementById("Y2search").options[j].selected&&a.push(document.getElementById("Y2search").options[j].value+",1,2");updateLink(a.join(";"))}
function mysearch(){searched=document.getElementById("search").value;$.get(treeService+"&search="+searched,function(a){var b="",d;for(d in a)b+='<option value="'+d+'">'+a[d]+"</option>";$("body").find("#Y1search").html(b);$("body").find("#Y2search").html(b)})}
function change_flot(){document.getElementById("show_flot").checked&&(document.getElementById("show_hc").checked=!1);document.getElementById("style_item")&&(document.getElementById("style_item").style.display=document.getElementById("show_hc").checked?"inline":"none")}function change_hc(){document.getElementById("show_hc").checked&&(document.getElementById("show_flot").checked=!1);document.getElementById("style_item").style.display=document.getElementById("show_hc").checked?"inline":"none"}
function csvCallback(){ts=document.getElementById("ts").value;start=document.getElementById("start").value;stop=document.getElementById("stop").value;csvTs(ts,start,stop)}function pngCallback(){Canvas2Image.saveAsPNG(myPlot.getCanvas())}function getQueryParams(a){a=a.split("+").join(" ");for(var b={},d,g=/[?&]?([^=]+)=([^&]*)/g;d=g.exec(a);)b[decodeURIComponent(d[1])]=decodeURIComponent(d[2]);return b}
function handleFileSelect(a){var b=document.getElementById("height").value.length?document.getElementById("height").value:$(window).height()-200;$("#mybackground").width($("#plotContainer").width()).height(b-0+10+"px");$("#placeholder").width($("#plotContainer").width()-10).height(b+"px");document.getElementById("placeholder").style.border="0px";a.stopPropagation();a.preventDefault();a=a.dataTransfer.files[0];b=new FileReader;b.onload=function(a){return function(a){lines=a.target.result.split("\n");
val=lines[0].split(",");col_number=val.length-1;for(var b=1,e=0;e<col_number;e++)myPlotClass[e]=[],myPlotClass[e].data=[],document.getElementById("show_hc")&&document.getElementById("show_hc").checked?myPlotClass[e].name=$.isNumeric(val[e+1])?"ts1"+e:val[e+1].replace(/&deg;/g,"\u00b0"):(myPlotClass[e].lines={show:!0,fill:!1},myPlotClass[e].label=$.isNumeric(val[e+1])?"ts1"+e:val[e+1]),"Y"==val[e+1].substring(0,1)&&$.isNumeric(val[e+1].substring(1,2))&&(myPlotClass[e].yAxis=val[e+1].substring(1,2)-
1,myPlotClass[e].yaxis=val[e+1].substring(1,2)-0,b<val[e+1].substring(1,2)&&(b=val[e+1].substring(1,2)));var d=-1;a=document.getElementById("show_table")&&document.getElementById("show_table").checked;for(var g='<table class="table table-striped table-bordered table-condensed" width="100%"><thead><tr><th>timestamp</th>',p=0;p<col_number;p++)g+="<th>"+myPlotClass[p].label+"</th>";g+="</tr></thead><tbody>";for(var q=p=0;q<lines.length;q++)if(val=lines[q].split(","),!(2>val.length)){if($.isNumeric(val[0]))timestamp=
val[0],e=new Date(1E3*val[0]);else if(0<=val[0].indexOf("-"))e=val[0].split(" "),e=new Date(e[0]+"T"+e[1]),timestamp=e.getTime()/1E3;else continue;if($.isNumeric(timestamp)&&0<timestamp){d++;0==p&&(p=1E3*timestamp);g+="<tr><td>"+e.toLocaleString()+"</td>";for(e=0;e<col_number;e++)g+="<td>"+val[e+1]+"</td>",""!==val[e+1]&&(myPlotClass[e].data[d]=[1E3*timestamp,parseFloat(val[e+1])]);g+="</tr>"}}stop=1E3*timestamp;if(document.getElementById("show_hc")&&document.getElementById("show_hc").checked){d=
"step";document.getElementById("style")&&document.getElementById("style").value.length&&(d=document.getElementById("style").value);d={chart:{renderTo:document.getElementById("placeholder"),type:"line",height:800},title:{text:"eGiga2m"},xAxis:{type:"datetime"},yAxis:[],tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%d/%m/%Y %H:%M:%S}: {point.y:.9f} "},type:"step"==d?"line":d,series:myPlotClass};Highcharts.setOptions({global:{useUTC:!1}});for(p=1;p<=b;p++)d.yAxis[p-1]={title:{text:"Y"+
p},opposite:2==b&&2==p};myPlot=b=new Highcharts.Chart(d)}else document.getElementById("show_flot")&&document.getElementById("show_flot").checked?(b={series:{lines:{show:!0}},grid:{hoverable:!0,clickable:!0},xaxis:{zoomRange:[.01,12E7],panRange:[p,stop],mode:"time",tickLength:5},yaxes:[{},{position:"right"}],legend:{position:"nw"},canvas:!0},myPlot=b=$.plot($("#placeholder"),myPlotClass,b)):($("#mybackground").height("1px"),$("#placeholder").height("1px"),document.getElementById("placeholder").innerHTML=
"");g+="</tbody></table>";document.getElementById("tableContainer").innerHTML=a?g:"";document.getElementById("pngCallback").style.display="inline"}}(a);b.readAsText(a)}
function handleTreeSelect(a){a.stopPropagation();a.preventDefault();attr=extractTimeseries(a.dataTransfer.getData("text"));addTs="copy"==a.dataTransfer.dropEffect;$.get(treeService+"&searchkey="+attr,function(a){"undefined"!==typeof a[0]&&(console.log(document.getElementById("ts").value),a=addTs&&document.getElementById("ts").value.length?document.getElementById("ts").value+";"+a[0]:a[0],updateLink(a),document.getElementById("ts").value=a)})}
function handleDragOver(a){a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="plot"}var dropZone=document.getElementById("plotContainer");dropZone.addEventListener("dragover",handleDragOver,!1);dropZone.addEventListener("drop",handleFileSelect,!1);if($("#tree").length){var dropTree=document.getElementById("tree");dropTree.addEventListener("dragover",handleDragOver,!1);dropTree.addEventListener("drop",handleTreeSelect,!1)}
function fillTable(a){var b="",d=[],g=[];b='<br><table class="table table-striped table-bordered table-condensed" width="100%"><thead><tr><th>time</th>';for(var h=0,e=0;e<a.length;e++)"clone"!=e&&"undefined"!==typeof a[e].label&&(h=e-0+1);for(e=0;e<a.length;e++)if("clone"!=e&&"undefined"!==typeof a[e].label){b+="<th>"+a[e].label+"</th>";for(var l=0;l<a[e].data.length;l++)"undefined"!==typeof a[e].data[l][0]&&("undefined"===typeof d[a[e].data[l][0]]&&(d[a[e].data[l][0]-0]=Array(h),g.push(a[e].data[l][0]-
0)),d[a[e].data[l][0]][e]=a[e].data[l][1])}b+="</tr></thead>\n<tbody>\n";g.sort(function(a,b){return a-b});for(l=0;l<g.length;l++)if(g[l]-0==g[l]&&"undefined"!==typeof g[l]&&"clone"!=g[l]){b+="<tr>";b+="<td>"+(new Date(g[l])).format("Y-m-d H:i:s")+"</td>";for(e=0;e<h;e++)b+="<td>"+("undefined"!==typeof d[g[l]]&&"undefined"!==typeof d[g[l]][e]?d[g[l]][e]:"&nbsp;")+"</td>";b+="</tr>\n"}b+="</tbody></table>";document.getElementById("tableContainer")&&(document.getElementById("tableContainer").innerHTML=
b)}function timeZoom(a,b,d){d=(d-a)/zoom_speed;a=1;864E6<d?a=864E5:3456E5<d?a=216E5:108E5<d?a=36E5:9E5<d&&(a=6E4);d=Math.round(d/a)*a;a*=Math.round((b-d/2)/a);b=new Date(a+d);return[(new Date(a)).format("Y-m-d H:i:s"),b.format("Y-m-d H:i:s")]}
function add_history(a){if(!(-1>myHistoryCounter+a&&myHistoryCounter+a>=myHistory.length)){myHistoryCounter+=a;if(0==a)myHistoryCounter+=1,myHistory.length=myHistoryCounter,myHistory[myHistoryCounter]=updateLink("history");else{a=getQueryParams(myHistory[myHistoryCounter]);plotTs(a.ts,a.start,"undefined"===typeof a.stop?"":a.stop);var b=["minY","maxY","logY","height","style"];for(c=0;c<b.length;c++)document.getElementById(b[c]).value="undefined"===typeof a[b[c]]?"":a[b[c]]}document.getElementById("myBack").style.display=
1>myHistoryCounter?"none":"inline";document.getElementById("myFwd").style.display=myHistoryCounter==myHistory.length-1?"none":"inline"}}function decodeTs(a){for(var b=a.split(";"),d=0;d<b.length;d++){var g=b[d].split(",");curves[d]={request:g[0],x:g[1],y:g[2],response:g[0]}}return a}
function newdecodeTs(a){a=a.split(";");for(var b=[],d=[],g=[],h,e=0;e<a.length;e++){h=-1;var l=a[e].split(",");"undefined"===typeof l[1]&&(l[1]=1);"undefined"===typeof l[2]&&(l[2]=1);if(-1<l[0].indexOf("$"))for(var m=l[0].split("$"),p=0;p<m.length;p++)p%2&&-1==d.indexOf(m[p]+","+l[1])&&(d.push(m[p]+","+l[1]),g.push(m[p]));else h=b.push(l[0]+","+l[1])-1;curves[e]={request:l[0],x:l[1],y:l[2],response:0<=h?h:g}}return b.concat($(d).not(b).get()).join(";")}function SortByTime(a,b){return a.x-b.x}
function strtr(a,b){var d,g;for(g in b)for(d="";a!==d;)d=a,a=d.replace(g,b[g]);return a}function mathEval(a){var b=!0;a=a.replace(/(?:[a-z$_][a-z0-9$_]*)|(?:[;={}\[\]"'!&<>^\\?:])/ig,function(a){if(Math.hasOwnProperty(a))return"Math."+a;b=!1});if(!b)return NaN;try{return eval(a)}catch(d){return NaN}}function evalFormulae(a){return a}
function plotTs(a,b,d){curves=[];myRequest=a;var g="";for(j=0;j<events.length;j++)g+=document.getElementById("show_"+events[j]).checked?"&show_"+events[j]+"="+document.getElementById("filter_"+events[j]).value:"";g=g+"&decimation="+decimation+"&decimation_samples="+decimationSamples;console.log(document.getElementById("hideOverMaxmin").checked);if(document.getElementById("hideOverMaxmin")&&document.getElementById("hideOverMaxmin").checked){g+="&hideOverMaxmin=";var h=document.getElementById("maxY").value;
1<h.length&&(g+="&maxY="+h);h=document.getElementById("minY").value;1<h.length&&(g+="&minY="+h)}h=document.getElementById("height").value.length?document.getElementById("height").value:$(window).height()-200;300>h&&(h=300);var e=$(window).width()-(0<$("#tree").length?280:0);300>e&&(e=300);$("#mybackground").width(e).height(h-0+10+"px");$("#placeholder").width(e-10).height(h+"px");$("#placeholder").html("&nbsp;&nbsp;&nbsp;&nbsp;<img src='./img/timer.gif'>");h="start="+b;e="";updatePlot=0;0<=d.indexOf("update")?
(e=d.split(","),updatePlot="undefined"===typeof e[1]?1:.1<e[1]?e[1]:.1,updateBackground="undefined"===typeof e[2]?300:60<e[2]?e[2]:60,e="&no_posttimer="):d.length&&(e="&stop="+d);var l=document.getElementById("show_hc").checked?"&prestart=hc":"";a=decodeTs(a);var m=d.length?new Date(d):new Date;$.get(plotService+"&Seconds_Behind_Master",function(a){60<a&&alert("WARNING\nThe data has not been updated for "+a+" seconds")});1>a.length?$("#placeholder").html("&nbsp;&nbsp;&nbsp;&nbsp;<h4>WARNING: No Time Series has been requested</h4>Please select e Time Series and a time period"):
$.get(plotService+"&"+h+e+"&ts="+a+l+g,function(a){for(var e=0,g=0;g<a.ts.length;g++)e+=a.ts[g].num_rows;0==e&&$("#placeholder").html("&nbsp;&nbsp;&nbsp;&nbsp;<h4>WARNING: No data available</h4>Please select e Time Series and a time period containing some data");console.log("num_rows: "+e);if(document.getElementById("downtimeCheck")&&document.getElementById("downtimeCheck").checked){g=a.ts[0].data[0].x?a.ts[0].data[0].x:a.ts[0].data[0][0];for(var h=[],l=0;l<a.ts.length;l++)e+=a.ts[l].num_rows,(m.valueOf()-
a.ts[l].data[a.ts[l].data.length-1][0])/(m.valueOf()-g)>10/a.ts[l].data.length&&h.push(a.ts[l].label);h.length&&alert("WARNIG\nsome data may be missing (may be server or replication downtime) for Time Series:\n"+h.join(","))}plotData(evalFormulae(a.ts),a.event,b,d)})}
function plotData(a,b,d,g){d=d.split(";");g=g.split(";");document.getElementById("show_hc").checked?(hcPlot(a,b,d,g),document.getElementById("pngCallback").style.display="none"):document.getElementById("show_flot").checked?(flotPlot(a,b,d,g),document.getElementById("pngCallback").style.display="inline"):($("#mybackground").height("1px"),$("#placeholder").height("1px"),document.getElementById("placeholder").innerHTML="");if(document.getElementById("show_table").checked)fillTable(a);else{b=0;tableData=
[];for(g=0;g<a.length;g++)a[g].isString&&(tableData[b++]=a[g]);b&&fillTable(tableData)}}
function flotPlot(a,b,d,g){b={series:{lines:{show:!0}},grid:{hoverable:!0,clickable:!0},xaxes:[{zoomRange:[.01,12E7],panRange:[13700376E5,14015736E5],mode:"time",timezone:"browser",tickLength:5}],yaxes:[{},{position:"right"}],legend:{position:"sw"},canvas:!0};myPlotClass=[];for(var h=document.getElementById("minY")&&document.getElementById("minY").value.length?document.getElementById("minY").value.split(";"):[],e=document.getElementById("maxY")&&document.getElementById("maxY").value.length?document.getElementById("maxY").value.split(";"):
[],l=document.getElementById("logY")&&document.getElementById("logY").value.length?document.getElementById("logY").value.split(";"):[],m=1,p=1,q=0;q<a.length;q++)"undefined"!==typeof a[q].label&&(myPlotClass[q]=[],myPlotClass[q].label=a[q].label,myPlotClass[q].xaxis=a[q].xaxis-0,myPlotClass[q].yaxis=a[q].yaxis-0,myPlotClass[q].data=a[q].data,myPlotClass[q].lines={show:!0,fill:!1},m<a[q].xaxis&&(m=a[q].xaxis),p<a[q].yaxis&&(p=a[q].yaxis));for(a=1;a<=p;a++)h[a-1]&&(b.yaxis[a-1].min=h[a-1]),e[a-1]&&
(b.yaxis[a-1].max=e[a-1]),l[a-1]&&"1"==l[a-1]&&(b.yaxes[a-1].transform=function(a){return 0<a?Math.log(a):-23},b.yaxes[a-1].inverseTransform=function(a){return Math.exp(a)});myPlot=$.plot($("#placeholder"),myPlotClass,b);$("#placeholder").append('<div style="position:absolute;left:120px;top:10px;color:#676;font-size:smaller">eGiga2m - '+d+" - "+g+"</div>");document.getElementById("pngCallback")&&(document.getElementById("pngCallback").style.display="inline");document.getElementById("hidetree")&&(document.getElementById("hidetree").style.display=
"inline")}function showTooltip(a,b,d){$('<div id="tooltip">'+d+"</div>").css({position:"absolute",display:"none",top:b+5,left:a+5,border:"1px solid #fdd",padding:"2px","background-color":"#fee",opacity:.8}).appendTo("body").fadeIn(200)}var previousPoint=null;
$("#placeholder").bind("plothover",function(a,b,d){"undefined"!==typeof b.x&&$("#x").text(b.x.toFixed(2));"undefined"!==typeof b.y&&$("#y").text(b.y.toFixed(2));d?previousPoint!=d.dataIndex&&(previousPoint=d.dataIndex,$("#tooltip").remove(),showTooltip(d.pageX,d.pageY,"&nbsp;&nbsp;"+d.datapoint[1]+"<br>&nbsp;&nbsp;"+(new Date(d.datapoint[0]-0)).toLocaleString())):($("#tooltip").remove(),previousPoint=null)});
$("#placeholder").bind("plotclick",function(a,b,d){if(document.getElementById("startInput")){for(a=0;"undefined"===typeof myPlotClass[0].data[a][0];)a++;startStop=timeZoom(myPlotClass[0].data[a][0],b.x,myPlotClass[0].data[myPlotClass[0].data.length-1][0]);document.getElementById("startInput").value=document.getElementById("start").value=startStop[0];document.getElementById("stopInput").value=document.getElementById("stop").value=startStop[1];plotTs(myRequest,startStop[0],startStop[1]);add_history(0)}else document.location=
"./index.html"+document.location.search});var printing=!1;
function hcPlot(a,b,d,g){var h="No data available in selected period",e=document.getElementById("height").value.length?document.getElementById("height").value:$(window).height()-200;300>e&&(e=300);var l="step",m=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],p=document.getElementById("minY")&&document.getElementById("minY").value.length?document.getElementById("minY").value.split(";"):[],q=document.getElementById("maxY")&&document.getElementById("maxY").value.length?document.getElementById("maxY").value.split(";"):
[],v=document.getElementById("logY")&&document.getElementById("logY").value.length?document.getElementById("logY").value.split(";"):[];document.getElementById("style")&&document.getElementById("style").value.length&&(l=document.getElementById("style").value);var r=1,t=1,n;for(n in curves)t<curves[n].y&&(t=curves[n].y);for(n=k=0;n<events.length;n++)document.getElementById("event_"+events[n]).style.display="none";for(n in curves)if("clone"!=n)if(a)for(;a[k]&&a[k].ts_id.split("[")[0]==curves[n].request;){myPlotClass[k]=
[];var w=a[k].query_time?a[k].query_time:0,x=0<w?", Samples per second: "+(a[k].num_rows/w).toFixed(0):"";w="Samples: "+a[k].data.length+(a[k].num_rows>a[k].data.length?"/"+a[k].num_rows:"")+(a[k].query_time?", query time: "+w.toFixed(2)+" [s]"+x:"");myPlotClass[k].shortName="undefined"!==typeof u&&"undefined"!==typeof u[k]?u[k]:(1<t?"Y"+(curves[n].y?curves[n].y:1)+" ":"")+a[k].label.replace(/&deg;/g,"\u00b0");myPlotClass[k].name='<span title="'+w+'">'+("undefined"!==typeof u&&"undefined"!==typeof u[k]?
u[k]:(1<t?"Y"+(curves[n].y?curves[n].y:1)+" ":"")+a[k].label.replace(/&deg;/g,"\u00b0"))+"</span>";"undefined"!==typeof $_GET.num_rows&&(myPlotClass[k].name=myPlotClass[k].name+" num_rows: "+a[k].num_rows);myPlotClass[k].xAxis=a[k].xaxis-1;myPlotClass[k].yAxis=$.isNumeric(curves[n].y)?curves[n].y-1:0;myPlotClass[k].data=a[k].data;myPlotClass[k].visible="undefined"!==typeof visible[k]?"true"==visible[k]:!0;myPlotClass[k].step="step"==l?"left":!1;r<a[k].xaxis&&(r=a[k].xaxis);"undefined"!==typeof a[k].categories&&
(m[a[k].yaxis-1]=a[k].categories);k++}else h="No variable selected";for(n in b)"clone"!=n&&"undefined"!==typeof fade_level[n]&&(myPlotClass[k]=[],"undefined"===typeof b[n].label&&(myPlotClass[k].name=n,myPlotClass[k].showInLegend=!1,myPlotClass[k].xAxis=0,myPlotClass[k].yAxis=0,myPlotClass[k].data=b[n].data,myPlotClass[k].type="scatter",myPlotClass[k].step=!1,document.getElementById("event_"+n).style.display="inline",k++));if("undefined"!==typeof window.$_GET.tsLabel){var u=window.$_GET.tsLabel.split(";");
for(n in a)myPlotClass[n].name="undefined"!==typeof u[n]?u[n]:u[0]}h={credits:{enabled:!1},exporting:{url:hcExportService},legend:{useHTML:!0},chart:{events:{beforePrint:function(){window.printing=!0},afterPrint:function(){window.printing=!0},click:function(a){if(!window.printing)if($("#plotContainer").width(),document.getElementById("startInput")){for(var b=0;"undefined"===typeof myPlotClass[0].data[b][0];)b++;startStop=timeZoom(myPlotClass[0].data[b][0],a.xAxis[0].value,myPlotClass[0].data[myPlotClass[0].data.length-
1][0]);document.getElementById("startInput").value=document.getElementById("start").value=startStop[0];document.getElementById("stopInput").value=document.getElementById("stop").value=startStop[1];plotTs(myRequest,startStop[0],startStop[1]);add_history(0)}else document.location=document.location.pathname.match(/[^\/]+$/)[0].replace("_plot.html",".html")+document.location.search;window.printing=!1},load:function(){if(updatePlot&&0!=updateService.length){for(var a=[],b=0;b<myPlotClass.length;b++)if("clone"!=
b){var e=myPlotClass[b].shortName;"Y"==e.substring(0,1)&&$.isNumeric(e.substring(1,2))&&(e=e.substring(3));a[b]=e}updateRequest=updateService+a.join(",");updateId=setInterval(function(){if(updateDecimation){if(0<updateCounter){updateCounter--;return}updateCounter=updateDecimation}$.get(updateRequest,function(a){for(var b in a)"clone"!=b&&15E11<a[b][0]&&myPlot.series[b].addPoint(a[b],!0,!1)})},1E3*updatePlot)}}},renderTo:placeholder,type:"step"==l?"line":l,height:e},title:{text:"eGiga2m"},plotOptions:{series:{animation:!updatePlot}},
xAxis:[],yAxis:[],tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%d/%m/%Y %H:%M:%S}: {point.y:.3f} ",formatter:function(){if(-1==activePoint)activePoint=0;else{activePoint=this.series.data.indexOf(this.point);for(var e=new Date(this.x),d="",g=0;g<myPlotClass.length;g++){myPlotClass[g].name==this.series.name&&this.x==myPlotClass[g].data[0].x&&"undefined"!==typeof myPlotClass[g].data[0].prestart&&(e=new Date(myPlotClass[g].data[0].prestart),d=" pre-start");if(myPlotClass[g].name==
this.series.name&&"error"==this.series.name)for(var h in myPlotClass[g].data)if(myPlotClass[g].data[h].x==this.x)return"<b>error</b><br><br>"+a[myPlotClass[g].data[h].message].label+"<br>"+e.format("Y-m-d H:i:s")+d+": <b><br>"+b.error.message[myPlotClass[g].data[h].message]+"</b>";if(myPlotClass[g].name==this.series.name&&"undefined"!==typeof fade_level[this.series.name])for(h in myPlotClass[g].data)if(myPlotClass[g].data[h].x==this.x)return"<b>"+this.series.name+"</b><br>"+e.format("Y-m-d H:i:s")+
": <b><br>"+b[this.series.name].message[myPlotClass[g].data[h].message]+"</b>";myPlotClass[g].name==this.series.name&&this.x==myPlotClass[g].data[myPlotClass[g].data.length-1].x&&"undefined"!==typeof myPlotClass[g].data[myPlotClass[g].data.length-1].poststart&&this.tooltip.hide()}return"<b>"+this.series.name+"</b><br>"+e.format("Y-m-d H:i:s")+d+": <b>"+this.y+"</b>"}}},lang:{noData:h},noData:{style:{fontWeight:"bold",fontSize:"15px",color:"#303030"}},series:myPlotClass};for(e=1;e<=r;e++)h.xAxis[e-
1]={type:"datetime",gridLineWidth:0,lineColor:"#000",title:{text:d[e-1]+" - "+g[e-1]},opposite:2==r&&2==e};"undefined"!==typeof window.$_GET.hideMenu&&(h.navigation={buttonOptions:{enabled:!1}});if("undefined"!==typeof window.$_GET.xShow)for(d=window.$_GET.xShow.split(";"),e=1;e<=r;e++)"0"==("undefined"!==typeof d[e-1]?d[e-1]:d[0])&&(h.xAxis[e-1].lineWidth=0,h.xAxis[e-1].labels={enabled:!1});if("undefined"!==typeof window.$_GET.xLabel||"undefined"!==typeof window.$_GET.xlabel)for(d=("undefined"!==
typeof window.$_GET.xLabel?window.$_GET.xLabel:window.$_GET.xlabel).split(";"),e=1;e<=r;e++)h.xAxis[e-1].title={text:"undefined"!==typeof d[e-1]?d[e-1]:d[0]};"undefined"!==typeof window.$_GET.title&&(h.title={text:window.$_GET.title});for(e=h.xAxis[0].gridLineWidth=1;e<=t;e++)h.yAxis[e-1]={title:{text:"Y"+(e?e:1)},opposite:2==t&&2==e},p[e-1]&&(h.yAxis[e-1].min=p[e-1]),q[e-1]&&(h.yAxis[e-1].max=q[e-1]),v[e-1]&&"1"==v[e-1]&&(h.yAxis[e-1].type="logarithmic"),h.yAxis[e-1].labels={formatter:function(){return this.value}},
m[e-1]&&(h.yAxis[e-1].categories=m[e-1]);if("undefined"!==typeof window.$_GET.yLabel)for(m=window.$_GET.yLabel.split(";"),e=1;e<=t;e++)h.yAxis[e-1].title={text:"undefined"!==typeof m[e-1]?m[e-1]:m[0]?m[0]:""};Highcharts.setOptions({global:{useUTC:!1}});myPlot=new Highcharts.Chart(h,function(a){-1!=mychart?mychart=this:(mychart=this,$(document).keydown(function(a){var b="undefined"===typeof mychart.hoverSeries?0:mychart.hoverSeries.index;switch(a.which){case 37:0<activePoint&&activePoint--;break;case 39:activePoint+
1<mychart.series[b].data.length&&activePoint++}"undefined"!==typeof mychart.series[b]&&mychart.tooltip.refresh(mychart.series[b].data[activePoint])}))});for(e in myPlotClass)!1===myPlotClass[e].showInLegend&&($("#event_"+myPlotClass[e].name).off("click"),$("#event_"+myPlotClass[e].name).click({name:e,label:myPlotClass[e].name},function(a){myPlotClass[a.data.name].name!==a.data.label||myPlotClass[a.data.name].done||(myPlot.series[a.data.name].setVisible(),fade_level[a.data.label]=1.5-fade_level[a.data.label],
$("#event_"+a.data.label).fadeTo(400,fade_level[a.data.label]))}))}
function flotFrameTs(){if(frameNum>=globalVal.length)animationDelay=0;else if(0!=animationDelay){var a=new Date(globalVal[frameNum][0]-0);$("body").find("#animationTime").html(a.format("Y-m-d H:i:s"));myPlotClass=[[]];myPlotClass[0].label=globalLabel;myPlotClass[0].data=globalVal[frameNum][1];myPlotClass[0].lines={show:!0,fill:!1};flotOptions.yaxis={position:"left",min:minVal,max:maxVal};$.plot($("#placeholder"),myPlotClass,flotOptions);$("#animationSlider").slider("value",frameNum);frameNum++;animationDelay&&
setTimeout(function(){flotFrameTs()},animationDelay)}}
function flotAnimationTs(a,b,d){$("#animationSlider").width($("#plotContainer").width()-20);globalVal=[];b="start="+b+"&decimation="+decimation+"&decimation_samples="+decimationSamples;var g="";d.length&&(g="&stop="+d);$.get(plotService+"&"+b+g+"&ts="+a+"&no_pretimer&no_posttimer",function(a){minVal=maxVal=a.ts[0].data[0][1][0];globalLabel=a.ts[0].label;for(var b,d=0;d<a.ts[0].data.length;d++){globalVal[d]=[a.ts[0].data[d][0],[]];for(var g=0;g<a.ts[0].data[d][1].length;g++)b=a.ts[0].data[d][1][g],
globalVal[d][1][g]=[g,b],minVal>b&&(minVal=b),maxVal<b&&(maxVal=b)}a=(maxVal-minVal)/20;maxVal+=a;minVal-=a;$("#animationSlider").slider({range:!1,min:0,max:globalVal.length-1});$("#animationSlider").slider({stop:function(a,b){frameNum=b.value;flotFrameTs()}});animationDelay=100;frameNum=0;setTimeout(function(){flotFrameTs()},10)})}
function hcFrameTs(){if(frameNum>=globalVal.length)animationDelay=0;else if(0!=animationDelay){var a=new Date(globalVal[frameNum][0]-0);$("body").find("#animationTime").html(a.format("Y-m-d H:i:s"));a=document.getElementById("placeholder");var b="step";document.getElementById("style")&&document.getElementById("style").value.length&&(b=document.getElementById("style").value);a={chart:{renderTo:a,type:"step"==b?"line":b,height:800},title:{text:"eGiga2m"},plotOptions:{series:{animation:!1}},yAxis:[{title:{text:"Y"},
labels:{formatter:function(){return 1E-5===this.value?0:this.value}}}],series:[{name:globalLabel,step:"step"==b?"left":!1,data:globalVal[frameNum][1]}]};a.yAxis[0].min=minVal;a.yAxis[0].max=maxVal;Highcharts.setOptions({global:{useUTC:!1}});new Highcharts.Chart(a);$("#animationSlider").slider("value",frameNum);frameNum++;animationDelay&&setTimeout(function(){hcFrameTs()},animationDelay)}}
function hcAnimationTs(a,b,d){$("#animationSlider").width($("#plotContainer").width()-20);globalVal=[];b="start="+b+"&decimation="+decimation+"&decimation_samples="+decimationSamples;var g="";d.length&&(g="&stop="+d);$.get(plotService+"&"+b+g+"&ts="+a+"&no_pretimer&no_posttimer",function(a){minVal=maxVal=a.ts[0].data[0][1][0];globalLabel=a.ts[0].label;for(var b,d=0;d<a.ts[0].data.length;d++){globalVal[d]=[a.ts[0].data[d][0],[]];for(var g=0;g<a.ts[0].data[d][1].length;g++)b=a.ts[0].data[d][1][g],globalVal[d][1][g]=
[g,b],minVal>b&&(minVal=b),maxVal<b&&(maxVal=b)}a=(maxVal-minVal)/20;maxVal+=a;minVal-=a;$("#animationSlider").slider({range:!1,min:0,max:globalVal.length-1});animationDelay=100;frameNum=0;$("#animationSlider").slider({stop:function(a,b){frameNum=b.value;hcFrameTs()}});setTimeout(function(){hcFrameTs()},10)})}function stopAnimation(){frameNum=animationDelay=0;$("#animationSlider").slider("value",frameNum)}function pauseAnimation(){animationDelay=0}
function playAnimation(){0==animationDelay&&(document.getElementById("show_flot").checked&&setTimeout(function(){flotFrameTs()},10),document.getElementById("show_hc").checked&&setTimeout(function(){hcFrameTs()},10));animationDelay=100}function ffAnimation(){0==animationDelay?(animationDelay=50,document.getElementById("show_flot").checked&&setTimeout(function(){flotFrameTs()},10),document.getElementById("show_hc").checked&&setTimeout(function(){hcFrameTs()},10)):animationDelay/=2}
var surfacePlot,data,options,basicPlotOptions,glOptions,animated,plot1,values=[],times=[];
function plotSurfaceTs(a,b,d){var g="";d.length&&(g="&stop="+d);$.get(plotService+"&"+("start="+b)+g+"&ts="+a+"&no_pretimer&no_posttimer",function(a){for(var b=a.ts[0].data.length,d=Math.round(b/5),g=0;g<b;g++)0==g%d&&(times[g/d]=(new Date(a.ts[0].data[g][0]-0)).format("Y-m-d H:i:s")),values[g]=a.ts[0].data[g][1];a=values[0].length;data={nRows:b,nCols:a,formattedValues:values};$("#placeholder").empty();surfacePlot=new SurfacePlot(document.getElementById("placeholder"));basicPlotOptions={fillPolygons:!0,
tooltips:[],renderPoints:!0};b=[];d=1;20<a&&(d=Math.round(a/10));for(g=0;g<=a;g+=d)b[g/d]=g;glOptions={xLabels:times,yLabels:b,chkControlId:"allowWebGL",autoCalcZScale:!0,animate:!1};options={xPos:0,yPos:0,width:1200,height:800,colourGradient:[{red:0,green:0,blue:255},{red:0,green:255,blue:255},{red:0,green:255,blue:0},{red:255,green:255,blue:0},{red:255,green:0,blue:0}],xTitle:"",yTitle:"samples",zTitle:"values",backColour:"#f8f8f8",axisTextColour:"#000000",hideFlatMinPolygons:!1,origin:{x:600,y:400}};
surfacePlot.draw(data,options,basicPlotOptions,glOptions)})};