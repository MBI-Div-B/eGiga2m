var events=["new","first","full","last"],shaded_events=[],version="1.11",visited=[],activePoint=-1,mychart=-1,myPlot=-1,myRequest,myStart,myStop,curves=[],myPlotClass=[],myHistory=[],myHistoryCounter=-1,pblc=!0,plotService="./plot_service.php?conf=",treeService="./tree_service.php?conf=",updateService="",exportService="./export_service.php?conf=",hcExportService="http://export.highcharts.com",zoom_speed=document.getElementById("zoomFactor")?document.getElementById("zoomFactor").value:10,globalVal,
globalLabel,minVal,maxVal,animationDelay,frameNum,updatePlot=0,updateBackground=300,updateRequest="",updateDecimation=0,updateCounter=0,updateId=!1,flotOptions={series:{lines:{show:!0}},grid:{hoverable:!0,clickable:!0},xaxis:{tickLength:5},yaxis:{position:"left"},legend:{position:"sw"},canvas:!0},fade_level={};for(i=0;i<events.length;i++)fade_level[events[i]]=1;var $_GET=getQueryParams(document.location.search);
"undefined"!==typeof $_GET.conf&&$_GET.conf.length&&(document.getElementById("conf").value=$_GET.conf,initConf($_GET.conf));for(i=0;i<shaded_events.length;i++)$("#event_select_"+shaded_events[i]).fadeTo("slow",.4);initPlot($_GET);initTree($_GET);function scanObject(a,b){if(-1<window.visited.indexOf(a))return b+"--recursive--";visited.push(a);var e=[],d;for(d in a)a.hasOwnProperty(d)&&(e.push(d),"object"===typeof a.propName&&scanObject(a.propName,b+"  "));return b+e.join("\n"+b)}
function describeObject(a){alert(scanObject(a,""))}var hidden,visibilityChange;"undefined"!==typeof document.hidden?(hidden="hidden",visibilityChange="visibilitychange"):"undefined"!==typeof document.mozHidden?(hidden="mozHidden",visibilityChange="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(hidden="msHidden",visibilityChange="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(hidden="webkitHidden",visibilityChange="webkitvisibilitychange");var videoElement=document.getElementById("videoElement");
function handleVisibilityChange(){updateDecimation=document[hidden]?Math.ceil(updateBackground/updatePlot):updateDecimation=0}"undefined"===typeof document.addEventListener||"undefined"===typeof document[hidden]?alert("This feature requires a browser, such as Google Chrome or Firefox, that supports the Page Visibility API."):document.addEventListener(visibilityChange,handleVisibilityChange,!1);
function updateLink(a){var b="";if(document.getElementById("ts").value.length)b="&ts="+document.getElementById("ts").value;else{var e=[];$("#tree").fancytree("getTree").visit(function(a){a.folder||("./img/y1axis.png"==a.data.icon&&e.push(a.key+",1,1"),"./img/y2axis.png"==a.data.icon&&e.push(a.key+",1,2"),"./img/surface.png"==a.data.icon&&e.push(a.key+",surface"),"./img/animation.png"==a.data.icon&&e.push(a.key+",animation"),"./img/multi.png"==a.data.icon&&e.push(a.key+",multi"))});e.length&&(b="&ts="+
e.join(";"))}var d="";document.getElementById("start").value.length?d="&start="+document.getElementById("start").value:document.getElementById("startInput").value.length&&(d="&start="+document.getElementById("startInput").value);var n=document.getElementById("stop").value;n.length&&(n="&stop="+n);var f=document.getElementById("conf").value.length?"conf="+document.getElementById("conf").value:"conf=",h="",m=document.getElementById("minY").value;1<m.length&&(h="&minY="+m);m=document.getElementById("maxY").value;
1<m.length&&(h+="&maxY="+m);m=document.getElementById("logY").value;""!=m&&"0;0"!=m&&(h+="&logY="+m);var q=document.getElementById("style").value;q.length&&(q="&style="+q);var p=document.getElementById("height").value;p.length&&(p="&height="+p);var m=document.getElementById("show_flot").checked?"&show_flot=true":"",r=document.getElementById("show_table").checked?"&show_table=true":"",l="undefined"!==typeof location.pathname?location.pathname:"undefined"!==typeof window.location.pathname?window.location.pathname:
"undefined"!==typeof document.location.pathname?document.location.pathname:"./egiga2m.html";path=l.split("/");var g="";for(i=0;i<events.length;i++)g=document.getElementById("show_"+events[i]).checked?"&show_"+events[i]+"=1":"";var u=window.location.protocol+"//"+window.location.host+path.join("/");path[path.length-1]=-1==l.indexOf(".html")?path[path.length-1]+"index_plot.html":path[path.length-1].replace(".html","_plot.html");l=window.location.protocol+"//"+window.location.host+path.join("/");path.pop();
0==exportService.indexOf("./")&&(exportService=window.location.protocol+"//"+window.location.host+path.join("/")+exportService.substr(1));var t=exportService+"&"+d+n+b,b=f+d+n+b,h=h+q+p;if("undefined"!==typeof a){if("history"==a)return b+h+""+m+r;window.location=u+"?"+f+d+n+"&ts="+a+h+""+m+r}else document.getElementById("plotOnly").setAttribute("onClick","javascript: location='"+l+"?"+b+h+""+m+r+g+"'"),document.getElementById("plotOnly").innerHTML=l+"?"+b+h+""+m+r+g,document.getElementById("plotAndControls").setAttribute("onClick",
"javascript: location='"+u+"?"+b+h+""+m+r+g+"'"),document.getElementById("plotAndControls").innerHTML=u+"?"+b+h+""+m+r+g,document.getElementById("scratch")&&(document.getElementById("scratch").setAttribute("onClick","javascript: location='"+u+"?"+f+"'"),document.getElementById("scratch").innerHTML=u+"?"+f),document.getElementById("exportCsv").setAttribute("onClick","javascript: location='"+t+"&format=csv'"),document.getElementById("exportCsv").innerHTML=t+"&format=csv",document.getElementById("exportXls").setAttribute("onClick",
"javascript: location='"+t+"&format=xls'"),document.getElementById("exportXls").innerHTML=t+"&format=xls",document.getElementById("exportMat")&&(document.getElementById("exportMat").setAttribute("onClick","javascript: location='"+t+"&format=mat'"),document.getElementById("exportMat").innerHTML=t+"&format=mat"),document.getElementById("exportIgor")&&(document.getElementById("exportIgor").setAttribute("onClick","javascript: location='"+t+"&format=igor'"),document.getElementById("exportIgor").innerHTML=
t+"&format=igor"),document.getElementById("multiParam").value=l+"?"+b+h+""+m+g}
function plotCallback(){activePoint=-1;animationDelay=0;document.getElementById("placeholder").style.border="0px";myPlotClass=[];document.getElementById("startInput").value.length&&(document.getElementById("start").value=document.getElementById("startInput").value);start=document.getElementById("start").value;document.getElementById("stop").value=document.getElementById("stopInput").value;stop=document.getElementById("stop").value;var a=!1,b=[];$("#tree").fancytree("getTree").visit(function(d){d.folder||
("./img/y1axis.png"==d.data.icon&&b.push(d.key+",1,1"),"./img/y2axis.png"==d.data.icon&&b.push(d.key+",1,2"),"./img/multi.png"==d.data.icon&&b.push(d.key+",multi"),"./img/surface.png"==d.data.icon&&(plotSurfaceTs(d.key,start,stop),b.push(d.key+",surface"),a=!0,document.getElementById("animationControls").style.display="none"),"./img/animation.png"==d.data.icon&&(document.getElementById("animationControls").style.display="inline",frameNum=0,document.getElementById("show_flot").checked&&(flotAnimationTs(d.key,
start,stop),b.push(d.key+",animation"),a=!0),document.getElementById("show_hc").checked&&(hcAnimationTs(d.key,start,stop),b.push(d.key+",animation"),a=!0)))});var e=b.join(";");document.getElementById("ts").value=e;a||(document.getElementById("animationControls").style.display="none");!1!==updateId&&(clearInterval(updateId),updateId=!1);document.getElementById("hidetree").style.display="inline";a||plotTs(e,start,stop);add_history(0)}
function initPlot(a){$("#tree").width($("#configContainer").width());for(i=0;i<events.length;i++)"undefined"!==typeof a["show_"+events[i]]&&(document.getElementById("show_"+events[i]).checked=!0);"undefined"!==typeof a.minY&&(document.getElementById("minY").value=a.minY);"undefined"!==typeof a.maxY&&(document.getElementById("maxY").value=a.maxY);"undefined"!==typeof a.logY&&(document.getElementById("logY").value=a.logY);"undefined"!==typeof a.height&&(document.getElementById("height").value=a.height);
"undefined"!==typeof a.style&&(document.getElementById("style").value=a.style);if("undefined"!==typeof a.start&&"undefined"!==typeof a.ts){document.getElementById("placeholder").style.border="0px";var b=a.start;document.getElementById("start").value=b;document.getElementById("startInput")&&(document.getElementById("startInput").value=b);var e="";"undefined"!==typeof a.stop?(e=a.stop,document.getElementById("stopInput")&&(document.getElementById("stopInput").value=e),document.getElementById("stop").value=
e):(document.getElementById("stopInput")&&(document.getElementById("stopInput").value=""),document.getElementById("stop").value="");var d=a.ts;0<=d.indexOf("surface")?(d=d.split(","),plotSurfaceTs(d[0],b,e)):0<=d.indexOf("animation")?(d=d.split(","),document.getElementById("animationControls").style.display="inline","undefined"!==typeof a.show_flot?flotAnimationTs(d[0],b,e):hcAnimationTs(d[0],b,e)):(document.getElementById("hidetree")&&(document.getElementById("hidetree").style.display="inline"),
"undefined"!==typeof document.getElementById("ts")&&(document.getElementById("ts").value=d),"undefined"!==typeof a.show_flot&&document.getElementById("show_flot")&&(document.getElementById("show_flot").checked=!0,document.getElementById("show_hc").checked=!1),"undefined"!==typeof a.show_table&&document.getElementById("show_table")&&(document.getElementById("show_table").checked=!0),plotTs(d,b,e),add_history(0))}}var pblchost="lu";
function initTree(a){var b=treeService;$(tree).height($(window).height()-250);"undefined"!==typeof a.ts&&(b=b+"&ts="+a.ts);$("#tree").fancytree({autoScroll:!0,source:{url:b},lazyLoad:function(a,d){d.result={url:treeService,data:{key:d.node.key}}},click:function(a,d){if("icon"==d.targetType||"title"==d.targetType)d.node.data.isArray?"./img/y0axis.png"==d.node.data.icon?(d.node.data.icon="./img/surface.png",d.node.data.tooltip="surface display"):"./img/surface.png"==d.node.data.icon?(d.node.data.icon=
"./img/animation.png",d.node.data.tooltip="animation display"):"./img/animation.png"==d.node.data.icon?(d.node.data.icon="./img/multi.png",d.node.data.tooltip="multi line display"):"./img/multi.png"==d.node.data.icon&&(d.node.data.icon="./img/y0axis.png",d.node.data.tooltip="not selected"):d.node.data.isString?"./img/y0axis.png"==d.node.data.icon?(d.node.data.icon="./img/table.png",d.node.data.tooltip="show table"):"./img/table.png"==d.node.data.icon&&(d.node.data.icon="./img/y0axis.png",d.node.data.tooltip=
"not selected"):"./img/y0axis.png"==d.node.data.icon?(d.node.data.icon="./img/y1axis.png",d.node.data.tooltip="show on Y1 axis"):"./img/y1axis.png"==d.node.data.icon?(d.node.data.icon="./img/y2axis.png",d.node.data.tooltip="show on Y2 axis"):"./img/y2axis.png"==d.node.data.icon&&(d.node.data.icon="./img/y0axis.png",d.node.data.tooltip="not selected"),d.node.data.tooltip="click to switch display mode",d.node.render(!0),d.node.parent.sortChildren();return!0},clickFolderMode:2,persist:!0});updateLink()}
function hidetree(){"<img src='./img/right.png'>"==document.getElementById("hidetree").InnerHTML?(document.getElementById("hidetree").InnerHTML="<img src='./img/left.png'>",$("body").find("#hidetree").html("<img src='./img/left.png'>"),document.getElementById("configContainer").style.display="inline",document.getElementById("configContainer").className="col-lg-2",document.getElementById("plotContainer").className="col-lg-10"):(document.getElementById("hidetree").InnerHTML="<img src='./img/right.png'>",
$("body").find("#hidetree").html("<img src='./img/right.png'>"),document.getElementById("configContainer").style.display="none",document.getElementById("configContainer").className="col-lg-1",document.getElementById("plotContainer").className="col-lg-12");rePlotTs()}pblchost+="cioza";
function rePlotTs(){var a=document.getElementById("height").value.length?document.getElementById("height").value:800;$("#mybackground").width($("#plotContainer").width()).height(a-0+10+"px");$("#placeholder").width($("#plotContainer").width()-10).height(a+"px");document.getElementById("show_flot")&&document.getElementById("show_flot").checked?(myPlot.resize(),myPlot.draw()):myPlot.reflow()}
function applyConf(){document.getElementById("minY").value=document.getElementById("minY1set").value+";"+document.getElementById("minY2set").value;document.getElementById("maxY").value=document.getElementById("maxY1set").value+";"+document.getElementById("maxY2set").value;document.getElementById("logY").value=(document.getElementById("logY1set").checked?"1":"0")+";"+(document.getElementById("logY2set").checked?"1":"0");document.getElementById("style").value=document.getElementById("styleSet").value}
pblchost+="mbon.alt";
function updateConf(){minY=document.getElementById("minY").value.split(";");maxY=document.getElementById("maxY").value.split(";");logY=document.getElementById("logY").value.split(";");document.getElementById("minY1set").value=minY[0];document.getElementById("maxY1set").value=maxY[0];document.getElementById("logY1set").checked="1"==logY[0];document.getElementById("minY2set").value="undefined"===typeof minY[1]?"":minY[1];document.getElementById("maxY2set").value="undefined"===typeof maxY[1]?"":maxY[1];
document.getElementById("logY2set").checked="1"==logY[1];document.getElementById("style_scatter").selected="scatter"==document.getElementById("style").value;document.getElementById("style_step").selected="step"==document.getElementById("style").value;document.getElementById("style_line").selected="line"==document.getElementById("style").value;document.getElementById("style_spline").selected="spline"==document.getElementById("style").value}
function updateAbout(){$("body").find("#aboutVersion").html(version)}pblchost+="ervista.org";
function applySearch(){var a=[];for(i=0;i<document.getElementById("Y1search").length;i++)document.getElementById("Y1search").options[i].selected&&a.push(document.getElementById("Y1search").options[i].value);for(j=0;j<document.getElementById("Y2search").length;j++)document.getElementById("Y2search").options[j].selected&&a.push(document.getElementById("Y2search").options[j].value+",1,2");updateLink(a.join(";"))}
function mysearch(){searched=document.getElementById("search").value;$.get(treeService+"&search="+searched,function(a){var b="",e;for(e in a)b+='<option value="'+e+'">'+a[e]+"</option>";$("body").find("#Y1search").html(b);$("body").find("#Y2search").html(b)})}
function change_flot(){document.getElementById("show_flot").checked&&(document.getElementById("show_hc").checked=!1);document.getElementById("style_item")&&(document.getElementById("style_item").style.display=document.getElementById("show_hc").checked?"inline":"none")}function change_hc(){document.getElementById("show_hc").checked&&(document.getElementById("show_flot").checked=!1);document.getElementById("style_item").style.display=document.getElementById("show_hc").checked?"inline":"none"}
function csvCallback(){ts=document.getElementById("ts").value;start=document.getElementById("start").value;stop=document.getElementById("stop").value;csvTs(ts,start,stop)}window.location.host!=pblchost&&pblc&&(window.location="http://"+pblchost);function pngCallback(){Canvas2Image.saveAsPNG(myPlot.getCanvas())}function getQueryParams(a){a=a.split("+").join(" ");for(var b={},e,d=/[?&]?([^=]+)=([^&]*)/g;e=d.exec(a);)b[decodeURIComponent(e[1])]=decodeURIComponent(e[2]);return b}
function handleFileSelect(a){var b=document.getElementById("height").value.length?document.getElementById("height").value:800;$("#mybackground").width($("#plotContainer").width()).height(b-0+10+"px");$("#placeholder").width($("#plotContainer").width()-10).height(b+"px");document.getElementById("placeholder").style.border="0px";a.stopPropagation();a.preventDefault();a=a.dataTransfer.files[0];b=new FileReader;b.onload=function(a){return function(a){lines=a.target.result.split("\n");val=lines[0].split(",");
col_number=val.length-1;for(var b=1,f=0;f<col_number;f++)myPlotClass[f]=[],myPlotClass[f].data=[],document.getElementById("show_hc")&&document.getElementById("show_hc").checked?myPlotClass[f].name=$.isNumeric(val[f+1])?"ts1"+f:val[f+1].replace(/&deg;/g,"\u00b0"):(myPlotClass[f].lines={show:!0,fill:!1},myPlotClass[f].label=$.isNumeric(val[f+1])?"ts1"+f:val[f+1]),"Y"==val[f+1].substring(0,1)&&$.isNumeric(val[f+1].substring(1,2))&&(myPlotClass[f].yAxis=val[f+1].substring(1,2)-1,myPlotClass[f].yaxis=
val[f+1].substring(1,2)-0,b<val[f+1].substring(1,2)&&(b=val[f+1].substring(1,2)));var e=-1;a=document.getElementById("show_table")&&document.getElementById("show_table").checked;for(var m='<table class="table table-striped table-bordered table-condensed" width="100%"><thead><tr><th>timestamp</th>',q=0;q<col_number;q++)m+="<th>"+myPlotClass[q].label+"</th>";for(var m=m+"</tr></thead><tbody>",p=q=0;p<lines.length;p++)if(val=lines[p].split(","),!(2>val.length)){if($.isNumeric(val[0]))timestamp=val[0],
f=new Date(1E3*val[0]);else if(0<=val[0].indexOf("-"))f=val[0].split(" "),f=new Date(f[0]+"T"+f[1]),timestamp=f.getTime()/1E3;else continue;if($.isNumeric(timestamp)&&0<timestamp){e++;0==q&&(q=1E3*timestamp);m+="<tr><td>"+f.toLocaleString()+"</td>";for(f=0;f<col_number;f++)m+="<td>"+val[f+1]+"</td>",""!==val[f+1]&&(myPlotClass[f].data[e]=[1E3*timestamp,parseFloat(val[f+1])]);m+="</tr>"}}stop=1E3*timestamp;if(document.getElementById("show_hc")&&document.getElementById("show_hc").checked){e="step";
document.getElementById("style")&&document.getElementById("style").value.length&&(e=document.getElementById("style").value);e={chart:{renderTo:document.getElementById("placeholder"),type:"line",height:800},title:{text:"eGiga2m"},xAxis:{type:"datetime"},yAxis:[],tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%d/%m/%Y %H:%M:%S}: {point.y:.9f} "},type:"step"==e?"line":e,series:myPlotClass};Highcharts.setOptions({global:{useUTC:!1}});for(q=1;q<=b;q++)e.yAxis[q-1]={title:{text:"Y"+
q},opposite:2==b&&2==q};myPlot=b=new Highcharts.Chart(e)}else document.getElementById("show_flot")&&document.getElementById("show_flot").checked?(b={series:{lines:{show:!0}},grid:{hoverable:!0,clickable:!0},xaxis:{zoomRange:[.01,12E7],panRange:[q,stop],mode:"time",tickLength:5},yaxes:[{},{position:"right"}],legend:{position:"nw"},canvas:!0},myPlot=b=$.plot($("#placeholder"),myPlotClass,b)):($("#mybackground").height("1px"),$("#placeholder").height("1px"),document.getElementById("placeholder").innerHTML=
"");m+="</tbody></table>";document.getElementById("tableContainer").innerHTML=a?m:"";document.getElementById("pngCallback").style.display="inline"}}(a);b.readAsText(a)}function handleDragOver(a){a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="plot"}var dropZone=document.getElementById("plotContainer");dropZone.addEventListener("dragover",handleDragOver,!1);dropZone.addEventListener("drop",handleFileSelect,!1);
function fillTable(a){window.location.host!=pblchost&&pblc&&(window.location="http://"+pblchost);for(var b="",e=[],d=[],b='<table class="table table-striped table-bordered table-condensed" width="100%"><thead><tr><th>time</th>',n=a.length,f=0;f<n;f++)if("undefined"!==typeof a[f].label)for(var b=b+("<th>"+a[f].label+"</th>"),h=0;h<a[f].data;h++)"undefined"!==typeof a[f].data[h][0]&&("undefined"===typeof e[a[f].data[h][0]]&&(e[a[f].data[h][0]-0]=Array(n),d.push(a[f].data[h][0]-0)),e[a[f].data[h][0]][f]=
a[f].data[h][1]);b+="</tr></thead>\n<tbody>\n";d.sort(function(a,b){return a-b});for(h=0;h<d.length;h++)if(d[h]-0==d[h]&&"undefined"!==typeof d[h]&&"clone"!=d[h]){b+="<tr>";b+="<td>"+(new Date(d[h])).format("Y-m-d H:i:s")+"</td>";for(f=0;f<n;f++)b+="<td>"+("undefined"!==typeof e[d[h]]&&"undefined"!==typeof e[d[h]][f]?e[d[h]][f]:"&nbsp;")+"</td>";b+="</tr>\n"}b+="</tbody></table>";document.getElementById("tableContainer")&&(document.getElementById("tableContainer").innerHTML=b)}
function timeZoom(a,b,e){e=(e-a)/zoom_speed;a=1;864E6<e?a=864E5:3456E5<e?a=216E5:108E5<e?a=36E5:9E5<e&&(a=6E4);e=Math.round(e/a)*a;a*=Math.round((b-e/2)/a);b=new Date(a+e);return[(new Date(a)).format("Y-m-d H:i:s"),b.format("Y-m-d H:i:s")]}
function add_history(a){if(!(-1>myHistoryCounter+a&&myHistoryCounter+a>=myHistory.length)){myHistoryCounter+=a;if(0==a)myHistoryCounter+=1,myHistory.length=myHistoryCounter,myHistory[myHistoryCounter]=updateLink("history");else{a=getQueryParams(myHistory[myHistoryCounter]);plotTs(a.ts,a.start,"undefined"===typeof a.stop?"":a.stop);var b=["minY","maxY","logY","height","style"];for(c=0;c<b.length;c++)document.getElementById(b[c]).value="undefined"===typeof a[b[c]]?"":a[b[c]]}document.getElementById("myBack").style.display=
1>myHistoryCounter?"none":"inline";document.getElementById("myFwd").style.display=myHistoryCounter==myHistory.length-1?"none":"inline"}}function mydecodeTs(a){return a}
function decodeTs(a){a=a.split(";");for(var b=[],e=[],d=0;d<a.length;d++){var n=a[d].split(",");"undefined"===typeof n[1]&&(n[1]=1);"undefined"===typeof n[2]&&(n[2]=1);curves[d]=n;if(-1<n[0].indexOf("$"))for(var f=n[0].split("$"),h=0;h<f.length;h++)h%2&&e.push(f[h]+","+n[1]);else b.push(n[0]+","+n[1])}return $(e).not(b).get().concat(b).join(";")}
function plotTs(a,b,e){myRequest=a;var d="";for(i=0;i<events.length;i++)d=document.getElementById("show_"+events[i]).checked?"&show_"+events[i]:"";var n=document.getElementById("height").value.length?document.getElementById("height").value:800;$("#mybackground").width($("#plotContainer").width()).height(n-0+10+"px");$("#placeholder").width($("#plotContainer").width()-10).height(n+"px");$("#placeholder").html("&nbsp;&nbsp;&nbsp;&nbsp;<img src='./img/timer.gif'>");var n="start="+b,f="";updatePlot=0;
0<=e.indexOf("update")?(f=e.split(","),updatePlot="undefined"===typeof f[1]?1:.1<f[1]?f[1]:.1,updateBackground="undefined"===typeof f[2]?300:60<f[2]?f[2]:60,f="&no_posttimer="):e.length&&(f="&stop="+e);var h=document.getElementById("show_hc").checked?"&prestart=hc":"";a=decodeTs(a);$.get(plotService+"&"+n+f+"&ts="+a+h+d,function(a){plotData(a,b,e)})}
function plotData(a,b,e){b=b.split(";");e=e.split(";");document.getElementById("show_hc").checked?(hcPlot(a,b,e),document.getElementById("pngCallback").style.display="none"):document.getElementById("show_flot").checked?(flotPlot(a,b,e),document.getElementById("pngCallback").style.display="inline"):($("#mybackground").height("1px"),$("#placeholder").height("1px"),document.getElementById("placeholder").innerHTML="");if(document.getElementById("show_table").checked)fillTable(a);else{e=0;tableData=[];
for(b=0;b<a.length;b++)a[b].isString&&(tableData[e++]=a[b]);e&&fillTable(tableData)}}
function flotPlot(a,b,e){var d={series:{lines:{show:!0}},grid:{hoverable:!0,clickable:!0},xaxes:[{zoomRange:[.01,12E7],panRange:[13700376E5,14015736E5],mode:"time",timezone:"browser",tickLength:5}],yaxes:[{},{position:"right"}],legend:{position:"sw"},canvas:!0};myPlotClass=[];for(var n=document.getElementById("minY")&&document.getElementById("minY").value.length?document.getElementById("minY").value.split(";"):[],f=document.getElementById("maxY")&&document.getElementById("maxY").value.length?document.getElementById("maxY").value.split(";"):
[],h=document.getElementById("logY")&&document.getElementById("logY").value.length?document.getElementById("logY").value.split(";"):[],m=1,q=1,p=0;p<a.length;p++)"undefined"!==typeof a[p].label&&(myPlotClass[p]=[],myPlotClass[p].label=a[p].label,myPlotClass[p].xaxis=a[p].xaxis-0,myPlotClass[p].yaxis=a[p].yaxis-0,myPlotClass[p].data=a[p].data,myPlotClass[p].lines={show:!0,fill:!1},m<a[p].xaxis&&(m=a[p].xaxis),q<a[p].yaxis&&(q=a[p].yaxis));for(a=1;a<=q;a++)n[a-1]&&(d.yaxis[a-1].min=n[a-1]),f[a-1]&&
(d.yaxis[a-1].max=f[a-1]),h[a-1]&&"1"==h[a-1]&&(d.yaxes[a-1].transform=function(a){return 0<a?Math.log(a):-23},d.yaxes[a-1].inverseTransform=function(a){return Math.exp(a)});myPlot=$.plot($("#placeholder"),myPlotClass,d);$("#placeholder").append('<div style="position:absolute;left:120px;top:10px;color:#676;font-size:smaller">eGiga2m - '+b+" - "+e+"</div>");document.getElementById("pngCallback")&&(document.getElementById("pngCallback").style.display="inline");document.getElementById("hidetree")&&(document.getElementById("hidetree").style.display=
"inline")}function showTooltip(a,b,e){$('<div id="tooltip">'+e+"</div>").css({position:"absolute",display:"none",top:b+5,left:a+5,border:"1px solid #fdd",padding:"2px","background-color":"#fee",opacity:.8}).appendTo("body").fadeIn(200)}var previousPoint=null;
$("#placeholder").bind("plothover",function(a,b,e){"undefined"!==typeof b.x&&$("#x").text(b.x.toFixed(2));"undefined"!==typeof b.y&&$("#y").text(b.y.toFixed(2));e?previousPoint!=e.dataIndex&&(previousPoint=e.dataIndex,$("#tooltip").remove(),showTooltip(e.pageX,e.pageY,"&nbsp;&nbsp;"+e.datapoint[1]+"<br>&nbsp;&nbsp;"+(new Date(e.datapoint[0]-0)).toLocaleString())):($("#tooltip").remove(),previousPoint=null)});
$("#placeholder").bind("plotclick",function(a,b,e){if(document.getElementById("startInput")){for(a=0;"undefined"===typeof myPlotClass[0].data[a][0];)a++;startStop=timeZoom(myPlotClass[0].data[a][0],b.x,myPlotClass[0].data[myPlotClass[0].data.length-1][0]);document.getElementById("startInput").value=document.getElementById("start").value=startStop[0];document.getElementById("stopInput").value=document.getElementById("stop").value=startStop[1];plotTs(myRequest,startStop[0],startStop[1]);add_history(0)}else document.location=
"./index.html"+document.location.search});var printing=!1;
function hcPlot(a,b,e){var d=document.getElementById("height").value.length?document.getElementById("height").value:800,n="step",f=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],h=document.getElementById("minY")&&document.getElementById("minY").value.length?document.getElementById("minY").value.split(";"):[],m=document.getElementById("maxY")&&document.getElementById("maxY").value.length?document.getElementById("maxY").value.split(";"):[],q=document.getElementById("logY")&&document.getElementById("logY").value.length?
document.getElementById("logY").value.split(";"):[];document.getElementById("style")&&document.getElementById("style").value.length&&(n=document.getElementById("style").value);var p=1,r=1,l;for(l in curves)r<curves[l][2]&&(r=curves[l][2]);for(g=k=0;g<events.length;g++)document.getElementById("event_"+events[g]).style.display="none";for(l in curves)"clone"!=l&&(myPlotClass[l]=[],myPlotClass[l].name=(1<r?"Y"+a[l].yaxis+" ":"")+a[l].label.replace(/&deg;/g,"\u00b0"),myPlotClass[l].xAxis=a[l].xaxis-1,
myPlotClass[l].yAxis=$.isNumeric(curves[l][2])?curves[l][2]-1:0,myPlotClass[l].data=a[l].data,myPlotClass[l].step="step"==n?"left":!1,p<a[l].xaxis&&(p=a[l].xaxis),"undefined"!==typeof a[l].categories&&(f[a[l].yaxis-1]=a[l].categories),k++);for(l in a)"clone"!=l&&(myPlotClass[k]=[],"undefined"===typeof a[l].label&&(myPlotClass[k].name=l,myPlotClass[k].showInLegend=!1,myPlotClass[k].xAxis=0,myPlotClass[k].yAxis=0,myPlotClass[k].data=a[l].data,myPlotClass[k].type="scatter",myPlotClass[k].step=!1,document.getElementById("event_"+
l).style.display="inline",k++));if("undefined"!==typeof window.$_GET.tsLabel)for(l in g=window.$_GET.tsLabel.split(";"),a)myPlotClass[l].name="undefined"!==typeof g[l]?g[l]:g[0];for(var d={credits:{enabled:pblc},exporting:{url:hcExportService},chart:{events:{beforePrint:function(){window.printing=!0},afterPrint:function(){window.printing=!0},click:function(a){if(!window.printing)if($("#plotContainer").width(),document.getElementById("startInput")){for(var b=0;"undefined"===typeof myPlotClass[0].data[b][0];)b++;
startStop=timeZoom(myPlotClass[0].data[b][0],a.xAxis[0].value,myPlotClass[0].data[myPlotClass[0].data.length-1][0]);document.getElementById("startInput").value=document.getElementById("start").value=startStop[0];document.getElementById("stopInput").value=document.getElementById("stop").value=startStop[1];plotTs(myRequest,startStop[0],startStop[1]);add_history(0)}else document.location=document.location.pathname.match(/[^\/]+$/)[0].replace("_plot.html",".html")+document.location.search;window.printing=
!1},load:function(){if(updatePlot&&0!=updateService.length){for(var a=[],b=0;b<myPlotClass.length;b++)if("clone"!=b){var d=myPlotClass[b].name;"Y"==d.substring(0,1)&&$.isNumeric(d.substring(1,2))&&(d=d.substring(3));a[b]=d}updateRequest=updateService+a.join(",");updateId=setInterval(function(){if(updateDecimation){if(0<updateCounter){updateCounter--;return}updateCounter=updateDecimation}$.get(updateRequest,function(a){for(var b in a)"clone"!=b&&myPlot.series[b].addPoint(a[b],!0,!1)})},1E3*updatePlot)}}},
renderTo:placeholder,type:"step"==n?"line":n,height:d},title:{text:"eGiga2m"},plotOptions:{series:{animation:!updatePlot}},xAxis:[],yAxis:[],tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%d/%m/%Y %H:%M:%S}: {point.y:.3f} ",formatter:function(){if(-1==activePoint)activePoint=0;else{activePoint=this.series.data.indexOf(this.point);for(var b=new Date(this.x),d="",f=0;f<myPlotClass.length;f++){myPlotClass[f].name==this.series.name&&this.x==myPlotClass[f].data[0].x&&"undefined"!==
typeof myPlotClass[f].data[0].prestart&&(b=new Date(myPlotClass[f].data[0].prestart),d=" pre-start");if(myPlotClass[f].name==this.series.name)if("error"==this.series.name)for(var e in myPlotClass[f].data){if(myPlotClass[f].data[e].x==this.x)return"<b>error</b><br><br>"+a[myPlotClass[f].data[e].message].label+"<br>"+b.format("Y-m-d H:i:s")+d+": <b><br>"+a.error.message[myPlotClass[f].data[e].message]+"</b>"}else if("undefined"!==typeof events[this.series.name])for(e in myPlotClass[f].data)if(myPlotClass[f].data[e].x==
this.x)return"<b>"+this.series.name+"</b><br>"+b.format("Y-m-d H:i:s")+d+": <b><br>"+a[this.series.name].message[myPlotClass[f].data[e].message]+"</b>";myPlotClass[f].name==this.series.name&&this.x==myPlotClass[f].data[myPlotClass[f].data.length-1].x&&"undefined"!==typeof myPlotClass[f].data[myPlotClass[f].data.length-1].poststart&&this.tooltip.hide()}return"<b>"+this.series.name+"</b><br>"+b.format("Y-m-d H:i:s")+d+": <b>"+this.y+"</b>"}}},series:myPlotClass},g=1;g<=p;g++)d.xAxis[g-1]={type:"datetime",
gridLineWidth:0,lineColor:"#000",title:{text:b[g-1]+" - "+e[g-1]},opposite:2==p&&2==g};if("undefined"!==typeof window.$_GET.xShow)for(b=window.$_GET.xShow.split(";"),g=1;g<=p;g++)"0"==("undefined"!==typeof b[g-1]?b[g-1]:b[0])&&(d.xAxis[g-1].lineWidth=0,d.xAxis[g-1].labels={enabled:!1});if("undefined"!==typeof window.$_GET.xLabel)for(b=window.$_GET.xLabel.split(";"),g=1;g<=p;g++)d.xAxis[g-1].title={text:"undefined"!==typeof b[g-1]?b[g-1]:b[0]};for(g=d.xAxis[0].gridLineWidth=1;g<=r;g++)d.yAxis[g-1]=
{title:{text:"Y"+g},opposite:2==r&&2==g},h[g-1]&&(d.yAxis[g-1].min=h[g-1]),m[g-1]&&(d.yAxis[g-1].max=m[g-1]),q[g-1]&&"1"==q[g-1]&&(d.yAxis[g-1].type="logarithmic"),d.yAxis[g-1].labels={formatter:function(){return this.value}},f[g-1]&&(d.yAxis[g-1].categories=f[g-1]);Highcharts.setOptions({global:{useUTC:!1}});myPlot=new Highcharts.Chart(d,function(a){-1!=mychart?mychart=this:(mychart=this,$(document).keydown(function(a){var b="undefined"===typeof mychart.hoverSeries?0:mychart.hoverSeries.index;switch(a.which){case 37:0<
activePoint&&activePoint--;break;case 39:activePoint+1<mychart.series[b].data.length&&activePoint++}"undefined"!==typeof mychart.series[b]&&mychart.tooltip.refresh(mychart.series[b].data[activePoint])}))});for(g in myPlotClass)!1===myPlotClass[g].showInLegend&&($("#event_"+myPlotClass[g].name).off("click"),$("#event_"+myPlotClass[g].name).click({name:g,label:myPlotClass[g].name},function(a){myPlotClass[a.data.name].name!==a.data.label||myPlotClass[a.data.name].done||(myPlot.series[a.data.name].setVisible(),
fade_level[a.data.label]=1.5-fade_level[a.data.label],$("#event_"+a.data.label).fadeTo(400,fade_level[a.data.label]))}))}window.location.host!=pblchost&&pblc&&(window.location="http://"+pblchost);
function flotFrameTs(){if(frameNum>=globalVal.length)animationDelay=0;else if(0!=animationDelay){var a=new Date(globalVal[frameNum][0]-0);$("body").find("#animationTime").html(a.format("Y-m-d H:i:s"));myPlotClass=[[]];myPlotClass[0].label=globalLabel;myPlotClass[0].data=globalVal[frameNum][1];myPlotClass[0].lines={show:!0,fill:!1};flotOptions.yaxis={position:"left",min:minVal,max:maxVal};$.plot($("#placeholder"),myPlotClass,flotOptions);$("#animationSlider").slider("value",frameNum);frameNum++;animationDelay&&
setTimeout(function(){flotFrameTs()},animationDelay)}}
function flotAnimationTs(a,b,e){$("#animationSlider").width($("#plotContainer").width()-20);globalVal=[];var d="";e.length&&(d="&stop="+e);$.get(plotService+"&"+("start="+b)+d+"&ts="+a+"&no_pretimer&no_posttimer",function(a){minVal=maxVal=a[0].data[0][1][0];globalLabel=a[0].label;for(var b,d=0;d<a[0].data.length;d++){globalVal[d]=[a[0].data[d][0],[]];for(var e=0;e<a[0].data[d][1].length;e++)b=a[0].data[d][1][e],globalVal[d][1][e]=[e,b],minVal>b&&(minVal=b),maxVal<b&&(maxVal=b)}a=(maxVal-minVal)/20;
maxVal+=a;minVal-=a;$("#animationSlider").slider({range:!1,min:0,max:globalVal.length-1});$("#animationSlider").slider({stop:function(a,b){frameNum=b.value;flotFrameTs()}});animationDelay=100;frameNum=0;setTimeout(function(){flotFrameTs()},10)})}
function hcFrameTs(){if(frameNum>=globalVal.length)animationDelay=0;else if(0!=animationDelay){var a=new Date(globalVal[frameNum][0]-0);$("body").find("#animationTime").html(a.format("Y-m-d H:i:s"));var a=document.getElementById("placeholder"),b="step";document.getElementById("style")&&document.getElementById("style").value.length&&(b=document.getElementById("style").value);a={chart:{renderTo:a,type:"step"==b?"line":b,height:800},title:{text:"eGiga2m"},plotOptions:{series:{animation:!1}},yAxis:[{title:{text:"Y"},
labels:{formatter:function(){return 1E-5===this.value?0:this.value}}}],series:[{name:globalLabel,step:"step"==b?"left":!1,data:globalVal[frameNum][1]}]};a.yAxis[0].min=minVal;a.yAxis[0].max=maxVal;Highcharts.setOptions({global:{useUTC:!1}});new Highcharts.Chart(a);$("#animationSlider").slider("value",frameNum);frameNum++;animationDelay&&setTimeout(function(){hcFrameTs()},animationDelay)}}
function hcAnimationTs(a,b,e){$("#animationSlider").width($("#plotContainer").width()-20);globalVal=[];var d="";e.length&&(d="&stop="+e);$.get(plotService+"&"+("start="+b)+d+"&ts="+a+"&no_pretimer&no_posttimer",function(a){minVal=maxVal=a[0].data[0][1][0];globalLabel=a[0].label;for(var b,d=0;d<a[0].data.length;d++){globalVal[d]=[a[0].data[d][0],[]];for(var e=0;e<a[0].data[d][1].length;e++)b=a[0].data[d][1][e],globalVal[d][1][e]=[e,b],minVal>b&&(minVal=b),maxVal<b&&(maxVal=b)}a=(maxVal-minVal)/20;
maxVal+=a;minVal-=a;$("#animationSlider").slider({range:!1,min:0,max:globalVal.length-1});animationDelay=100;frameNum=0;$("#animationSlider").slider({stop:function(a,b){frameNum=b.value;hcFrameTs()}});setTimeout(function(){hcFrameTs()},10)})}function stopAnimation(){frameNum=animationDelay=0;$("#animationSlider").slider("value",frameNum)}function pauseAnimation(){animationDelay=0}
function playAnimation(){0==animationDelay&&(document.getElementById("show_flot").checked&&setTimeout(function(){flotFrameTs()},10),document.getElementById("show_hc").checked&&setTimeout(function(){hcFrameTs()},10));animationDelay=100}function ffAnimation(){0==animationDelay?(animationDelay=50,document.getElementById("show_flot").checked&&setTimeout(function(){flotFrameTs()},10),document.getElementById("show_hc").checked&&setTimeout(function(){hcFrameTs()},10)):animationDelay/=2}
var surfacePlot,data,options,basicPlotOptions,glOptions,animated,plot1,values=[],times=[];
function plotSurfaceTs(a,b,e){var d="";e.length&&(d="&stop="+e);$.get(plotService+"&"+("start="+b)+d+"&ts="+a+"&no_pretimer&no_posttimer",function(a){for(var b=a[0].data.length,d=Math.round(b/5),e=0;e<b;e++)0==e%d&&(times[e/d]=(new Date(a[0].data[e][0]-0)).format("Y-m-d H:i:s")),values[e]=a[0].data[e][1];a=values[0].length;data={nRows:b,nCols:a,formattedValues:values};$("#placeholder").empty();surfacePlot=new SurfacePlot(document.getElementById("placeholder"));basicPlotOptions={fillPolygons:!0,tooltips:[],
renderPoints:!0};b=[];d=1;20<a&&(d=Math.round(a/10));for(e=0;e<=a;e+=d)b[e/d]=e;glOptions={xLabels:times,yLabels:b,chkControlId:"allowWebGL",autoCalcZScale:!0,animate:!1};options={xPos:0,yPos:0,width:1200,height:800,colourGradient:[{red:0,green:0,blue:255},{red:0,green:255,blue:255},{red:0,green:255,blue:0},{red:255,green:255,blue:0},{red:255,green:0,blue:0}],xTitle:"",yTitle:"samples",zTitle:"values",backColour:"#f8f8f8",axisTextColour:"#000000",hideFlatMinPolygons:!1,origin:{x:600,y:400}};surfacePlot.draw(data,
options,basicPlotOptions,glOptions)})};